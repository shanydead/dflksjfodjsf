Ты — ClawdBot, senior backend engineer, data architect и LLM systems auditor.
Проведи ПОЛНЫЙ АУДИТ текущей системы: код + база данных + пайплайны + инфраструктура.

Цель аудита:
- найти баги, архитектурные ошибки, лишние или дублирующие компоненты
- выявить риски по надёжности, производительности и стоимости
- проверить корректность работы с embeddings, pgvector, очередями и памятью
- дать чёткий и выполнимый план улучшений

────────────────────────────────────────
КОНТЕКСТ СИСТЕМЫ (ТЕКУЩЕЕ СОСТОЯНИЕ)
────────────────────────────────────────

Технологии:
- Node.js
- PostgreSQL + pgvector
- OpenAI embeddings
- Локальный PostgreSQL (активно используется)
- Neon.tech (создан, почти не используется)
- Redis/Kafka отсутствуют (и добавлять не планируется)

Файлы/модули (минимум):
- ingest.js — ingestion данных из мониторов
- index.js — MemoryDB / searchItems (семантический поиск)
- embeddings.js — генерация embeddings (частично или полностью)
- embedding queue реализуется через PostgreSQL
- worker для embeddings (или планируется)
- диалог бота должен сохраняться в БД (short-term + long-term memory)

Функциональность:
- мониторинг новостей / соцсетей / рынков прогнозов
- embeddings + semantic search
- граф связей (nodes/edges)
- propagation chains (кто первый, кто разогнал)
- инсайдерские сигналы (early_report, amplifier, market_lead)
- диалоговая память бота (chat_turns, memory_facts)
- система должна работать 24/7

────────────────────────────────────────
ЗАДАЧИ АУДИТА (ОБЯЗАТЕЛЬНО ВЫПОЛНИ ВСЕ)
────────────────────────────────────────

### 1) Аудит проекта (инвентаризация)
- выведи дерево файлов проекта
- отметь:
  - реально используемые файлы
  - неиспользуемые / устаревшие
  - дублирующие ответственность
- проверь package.json:
  - лишние зависимости
  - устаревшие версии
  - скрипты, которые не используются
- оцени структуру проекта (что стоит разделить/объединить)

### 2) Аудит PostgreSQL схемы
- перечисли все таблицы
- для каждой таблицы:
  - используется ли она кодом
  - какие поля реально нужны
  - есть ли лишние поля
- проверь:
  - pgvector подключён и используется корректно
  - размерность embeddings везде одинакова
  - embedding_model / version не смешиваются
- проверь индексы:
  - есть ли ANN индекс (HNSW / IVFFLAT)
  - есть ли индексы по времени (ts, created_at)
  - есть ли GIN по metadata
- найди таблицы/колонки, которые можно удалить

### 3) Аудит embeddings pipeline
- убедись, что embeddings:
  - не генерируются синхронно в ingest
  - не дублируются для одного и того же текста
- проверь очередь embeddings:
  - idempotency
  - retries
  - max attempts
  - backoff
  - batch size
- оцени стоимость:
  - что именно эмбеддится
  - где можно сократить объём
- проверь безопасность:
  - ключ OpenAI не логируется
  - нет утечек текста

### 4) Аудит embedding worker
- корректно ли используется:
  - FOR UPDATE SKIP LOCKED
  - параллельные воркеры
- worker:
  - не падает целиком из-за одной ошибки
  - корректно закрывает соединения
- проверь SQL обновления embedding:
  - whitelist target_table
  - защита от SQL injection

### 5) Аудит semantic search
- проверь searchItems():
  - используется правильный оператор distance (<=>)
  - есть LIMIT
  - фильтрация embedding IS NOT NULL
- проверь explain analyze для ключевых запросов
- оцени latency при росте данных (100k / 1M embeddings)

### 6) Аудит графа и propagation
- проверь:
  - корректно ли создаются связи (edges)
  - нет ли циклов/мусора
- оцени propagation logic:
  - reply / repost / forward / cluster
  - корректность определения “первого источника”
- найди места, где graph можно упростить или усилить

### 7) Аудит памяти диалога
- short-term memory:
  - chat_turns
  - ограничение по количеству/времени
- long-term memory:
  - memory_facts
  - кристаллизация
  - дедуп по canonical_key
- проверь:
  - не захламляется ли long-term
  - есть ли источники (source_turn_ids)
- оцени retrieval:
  - порядок (recent → facts → news → signals)
  - приоритеты

### 8) Аудит Neon vs Local Postgres
- проанализируй:
  - текущее использование локальной БД
  - состояние Neon
- дай рекомендацию:
  A) Neon primary + local dev
  B) local primary + Neon backup
- если схемы расходятся:
  - предложи план унификации
  - миграции
  - cutover без даунтайма

### 9) Безопасность
- .env / config:
  - нет ли секретов в коде
- .gitignore:
  - корректен ли
- логирование:
  - нет ли утечки данных
- SQL injection
- DoS / runaway workers

────────────────────────────────────────
ФОРМАТ ВЫХОДА (СТРОГО)
────────────────────────────────────────

1) EXECUTIVE SUMMARY (5–10 пунктов)
   - что хорошо
   - что плохо
   - что критично

2) ISSUE LIST (таблица):
   - проблема
   - уровень (critical / medium / low)
   - где (файл / таблица / запрос)
   - риск
   - как исправить
   - примерный effort

3) DELETE LIST
   - файлы
   - таблицы
   - индексы
   - код, который можно удалить сейчас

4) RECOMMENDED ARCHITECTURE (итог)
   - финальная структура проекта
   - финальная схема БД
   - роль очереди embeddings
   - роль Neon / local

5) QUICK WINS (≤ 1 часа)
   - конкретные правки, которые дадут быстрый эффект

6) NEXT STEPS (1–2 недели)
   - пошаговый план

────────────────────────────────────────
ПРАВИЛА
────────────────────────────────────────

- Ничего не угадывай: если нет данных — явно пометь как assumption
- Каждый вывод подкрепляй конкретикой (файл / SQL / логика)
- Приоритет: correctness → reliability → cost → performance
- Пиши жёстко, честно и по делу, без воды

Начинай аудит немедленно.
Сначала — инвентаризация проекта, затем БД и пайплайны.